<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <!-- Meta Tags for Performance & SEO -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive architecture walkthrough of Claude Code CLI + Manus MCP FSM Orchestrator">
    <meta name="keywords" content="FSM, Orchestrator, Claude Code, MCP, Architecture, Manus">
    <meta name="author" content="Manus Team">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Title -->
    <title>Manus FSM Orchestrator - Architecture Walkthrough</title>
    
    <!-- Enhanced CSS Theme System -->
    <style>
        :root {
            /* Core System Colors */
            --primary-50: #eff6ff;
            --primary-100: #dbeafe;
            --primary-200: #bfdbfe;
            --primary-300: #93c5fd;
            --primary-400: #60a5fa;
            --primary-500: #3b82f6;
            --primary-600: #2563eb;
            --primary-700: #1d4ed8;
            --primary-800: #1e40af;
            --primary-900: #1e3a8a;
            
            --secondary-50: #f8fafc;
            --secondary-100: #f1f5f9;
            --secondary-200: #e2e8f0;
            --secondary-300: #cbd5e1;
            --secondary-400: #94a3b8;
            --secondary-500: #64748b;
            --secondary-600: #475569;
            --secondary-700: #334155;
            --secondary-800: #1e293b;
            --secondary-900: #0f172a;
            
            /* Light Theme Colors */
            --primary-color: var(--primary-600);
            --primary-hover: var(--primary-700);
            --primary-light: var(--primary-100);
            --secondary-color: var(--secondary-500);
            --accent-color: #f59e0b;
            --accent-hover: #d97706;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: var(--primary-500);
            
            --background-color: #ffffff;
            --surface-color: var(--secondary-50);
            --surface-elevated: #ffffff;
            --text-primary: var(--secondary-900);
            --text-secondary: var(--secondary-600);
            --text-muted: var(--secondary-400);
            --text-inverse: #ffffff;
            --border-color: var(--secondary-200);
            --border-light: var(--secondary-100);
            --border-strong: var(--secondary-300);
            
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.15);
            --shadow-strong: rgba(0, 0, 0, 0.25);
            --gradient-primary: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-500) 100%);
            --gradient-secondary: linear-gradient(135deg, var(--secondary-500) 0%, var(--secondary-600) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
            
            /* Theme-specific adjustments */
            --focus-ring: 0 0 0 3px rgba(59, 130, 246, 0.1);
            --focus-ring-offset: 2px;
        }
        
        [data-theme="dark"] {
            /* Dark Theme Colors */
            --primary-color: var(--primary-400);
            --primary-hover: var(--primary-300);
            --primary-light: var(--primary-900);
            --secondary-color: var(--secondary-400);
            --accent-color: #fbbf24;
            --accent-hover: #f59e0b;
            --success-color: #34d399;
            --warning-color: #fbbf24;
            --error-color: #f87171;
            --info-color: var(--primary-400);
            
            --background-color: var(--secondary-900);
            --surface-color: var(--secondary-800);
            --surface-elevated: var(--secondary-700);
            --text-primary: var(--secondary-50);
            --text-secondary: var(--secondary-300);
            --text-muted: var(--secondary-500);
            --text-inverse: var(--secondary-900);
            --border-color: var(--secondary-700);
            --border-light: var(--secondary-800);
            --border-strong: var(--secondary-600);
            
            --shadow-light: rgba(0, 0, 0, 0.3);
            --shadow-medium: rgba(0, 0, 0, 0.4);
            --shadow-strong: rgba(0, 0, 0, 0.6);
            --gradient-primary: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
            --gradient-secondary: linear-gradient(135deg, var(--secondary-400) 0%, var(--secondary-500) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
            
            --focus-ring: 0 0 0 3px rgba(96, 165, 250, 0.2);
        }
        
        /* High Contrast Theme */
        [data-theme="high-contrast"] {
            --primary-color: #000000;
            --primary-hover: #333333;
            --primary-light: #f0f0f0;
            --secondary-color: #666666;
            --accent-color: #ff6600;
            --accent-hover: #e55a00;
            --success-color: #00aa00;
            --warning-color: #ffaa00;
            --error-color: #cc0000;
            --info-color: #0066cc;
            
            --background-color: #ffffff;
            --surface-color: #ffffff;
            --surface-elevated: #ffffff;
            --text-primary: #000000;
            --text-secondary: #333333;
            --text-muted: #666666;
            --text-inverse: #ffffff;
            --border-color: #000000;
            --border-light: #333333;
            --border-strong: #000000;
            
            --shadow-light: rgba(0, 0, 0, 0.3);
            --shadow-medium: rgba(0, 0, 0, 0.5);
            --shadow-strong: rgba(0, 0, 0, 0.7);
            --gradient-primary: linear-gradient(135deg, #000000 0%, #333333 100%);
            --gradient-secondary: linear-gradient(135deg, #666666 0%, #333333 100%);
            --gradient-accent: linear-gradient(135deg, #ff6600 0%, #e55a00 100%);
            
            --focus-ring: 0 0 0 4px #ff6600;
            --focus-ring-offset: 2px;
        }
        
        /* Dark High Contrast Theme */
        [data-theme="dark-high-contrast"] {
            --primary-color: #ffffff;
            --primary-hover: #cccccc;
            --primary-light: #333333;
            --secondary-color: #aaaaaa;
            --accent-color: #ffaa00;
            --accent-hover: #ffcc33;
            --success-color: #00ff00;
            --warning-color: #ffff00;
            --error-color: #ff3333;
            --info-color: #3399ff;
            
            --background-color: #000000;
            --surface-color: #000000;
            --surface-elevated: #111111;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #aaaaaa;
            --text-inverse: #000000;
            --border-color: #ffffff;
            --border-light: #cccccc;
            --border-strong: #ffffff;
            
            --shadow-light: rgba(255, 255, 255, 0.1);
            --shadow-medium: rgba(255, 255, 255, 0.2);
            --shadow-strong: rgba(255, 255, 255, 0.3);
            --gradient-primary: linear-gradient(135deg, #ffffff 0%, #cccccc 100%);
            --gradient-secondary: linear-gradient(135deg, #aaaaaa 0%, #cccccc 100%);
            --gradient-accent: linear-gradient(135deg, #ffaa00 0%, #ffcc33 100%);
            
            --focus-ring: 0 0 0 4px #ffaa00;
            --focus-ring-offset: 2px;
        }
        
        /* Auto Theme (System Preference) */
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme]) {
                --primary-color: var(--primary-400);
                --primary-hover: var(--primary-300);
                --primary-light: var(--primary-900);
                --secondary-color: var(--secondary-400);
                --accent-color: #fbbf24;
                --accent-hover: #f59e0b;
                --success-color: #34d399;
                --warning-color: #fbbf24;
                --error-color: #f87171;
                --info-color: var(--primary-400);
                
                --background-color: var(--secondary-900);
                --surface-color: var(--secondary-800);
                --surface-elevated: var(--secondary-700);
                --text-primary: var(--secondary-50);
                --text-secondary: var(--secondary-300);
                --text-muted: var(--secondary-500);
                --text-inverse: var(--secondary-900);
                --border-color: var(--secondary-700);
                --border-light: var(--secondary-800);
                --border-strong: var(--secondary-600);
                
                --shadow-light: rgba(0, 0, 0, 0.3);
                --shadow-medium: rgba(0, 0, 0, 0.4);
                --shadow-strong: rgba(0, 0, 0, 0.6);
                --gradient-primary: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
                --gradient-secondary: linear-gradient(135deg, var(--secondary-400) 0%, var(--secondary-500) 100%);
                --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
                
                --focus-ring: 0 0 0 3px rgba(96, 165, 250, 0.2);
            }
        }
        
        /* Enhanced Color Utility Classes */
        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .text-muted { color: var(--text-muted); }
        .text-inverse { color: var(--text-inverse); }
        .text-success { color: var(--success-color); }
        .text-warning { color: var(--warning-color); }
        .text-error { color: var(--error-color); }
        .text-info { color: var(--info-color); }
        
        .bg-primary { background-color: var(--primary-color); }
        .bg-secondary { background-color: var(--secondary-color); }
        .bg-surface { background-color: var(--surface-color); }
        .bg-surface-elevated { background-color: var(--surface-elevated); }
        .bg-success { background-color: var(--success-color); }
        .bg-warning { background-color: var(--warning-color); }
        .bg-error { background-color: var(--error-color); }
        .bg-info { background-color: var(--info-color); }
        
        .border-default { border-color: var(--border-color); }
        .border-light { border-color: var(--border-light); }
        .border-strong { border-color: var(--border-strong); }
        
        /* Theme Transition Support */
        * {
            transition-property: background-color, border-color, color, box-shadow;
            transition-duration: 0.2s;
            transition-timing-function: ease-in-out;
        }
        
        /* Contrast Ratio Improvements */
        @media (prefers-contrast: high) {
            :root {
                --border-color: var(--border-strong);
                --shadow-light: var(--shadow-medium);
                --shadow-medium: var(--shadow-strong);
            }
        }
        
        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--background-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Layout Grid */
        .layout-grid {
            display: grid;
            grid-template-areas: 
                "header"
                "nav"
                "main"
                "footer";
            grid-template-rows: auto auto 1fr auto;
            min-height: 100vh;
        }
        
        @media (min-width: 1024px) {
            .layout-grid {
                grid-template-areas: 
                    "header header"
                    "nav main"
                    "nav main"
                    "footer footer";
                grid-template-columns: 280px 1fr;
                grid-template-rows: auto 1fr auto;
            }
        }
        
        /* Header Styles */
        .main-header {
            grid-area: header;
            background: var(--gradient-primary);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 8px var(--shadow-light);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .header-title {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .header-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.2rem;
        }
        
        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.2s ease;
        }
        
        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Navigation Styles */
        .main-nav {
            grid-area: nav;
            background: var(--surface-color);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem 0;
            overflow-y: auto;
        }
        
        .nav-list {
            list-style: none;
            padding: 0 1rem;
        }
        
        .nav-item {
            margin-bottom: 0.5rem;
        }
        
        .nav-link {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .nav-link:hover,
        .nav-link.active {
            background: var(--primary-color);
            color: white;
            transform: translateX(4px);
        }
        
        .nav-section-title {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 1.5rem 1rem 0.5rem;
        }
        
        /* Main Content Styles */
        .main-content {
            grid-area: main;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }
        
        /* Section Styles */
        .content-section {
            margin-bottom: 3rem;
            padding: 2rem;
            background: var(--surface-color);
            border-radius: 12px;
            box-shadow: 0 2px 8px var(--shadow-light);
            border: 1px solid var(--border-color);
        }
        
        .section-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .section-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .section-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            max-width: 600px;
        }
        
        /* Interactive Component Styles */
        .interactive-container {
            background: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .fsm-diagram-container {
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--background-color);
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .fsm-diagram-container:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 24px var(--shadow-medium);
        }
        
        .diagram-placeholder {
            text-align: center;
            color: var(--text-muted);
            font-size: 1.1rem;
            z-index: 1;
        }
        
        /* FSM State Node Styles */
        .fsm-state {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient-primary);
            border: 3px solid var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px var(--shadow-light);
            will-change: transform, box-shadow;
        }
        
        .fsm-state:hover {
            transform: scale(1.1) translateZ(0);
            box-shadow: 0 8px 24px var(--shadow-medium);
            border-color: var(--accent-color);
        }
        
        .fsm-state.active {
            animation: pulseGlow 2s infinite;
            background: var(--gradient-secondary);
            border-color: var(--accent-color);
            transform: scale(1.05);
        }
        
        .fsm-state.completed {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-color: #10b981;
        }
        
        @keyframes pulseGlow {
            0%, 100% {
                box-shadow: 0 4px 12px var(--shadow-light), 0 0 0 0 rgba(37, 99, 235, 0.4);
            }
            50% {
                box-shadow: 0 8px 24px var(--shadow-medium), 0 0 0 10px rgba(37, 99, 235, 0);
            }
        }
        
        .fsm-state-label {
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
            text-align: center;
            line-height: 1.2;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        /* FSM Connection Lines */
        .fsm-connection {
            position: absolute;
            height: 2px;
            background: var(--primary-color);
            transform-origin: left center;
            opacity: 0.7;
            transition: all 0.3s ease;
            z-index: 0;
        }
        
        .fsm-connection::after {
            content: '';
            position: absolute;
            right: -8px;
            top: -4px;
            width: 0;
            height: 0;
            border-left: 8px solid var(--primary-color);
            border-top: 4px solid transparent;
            border-bottom: 4px solid transparent;
        }
        
        .fsm-connection.active {
            background: var(--accent-color);
            opacity: 1;
            height: 3px;
            animation: flowingLine 1.5s infinite linear;
        }
        
        .fsm-connection.active::after {
            border-left-color: var(--accent-color);
        }
        
        @keyframes flowingLine {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 20px 0;
            }
        }
        
        /* FSM State Tooltip */
        .fsm-state-tooltip {
            position: absolute;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem;
            box-shadow: 0 8px 24px var(--shadow-medium);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transform: translateY(10px);
            transition: all 0.2s ease;
            max-width: 200px;
        }
        
        .fsm-state:hover .fsm-state-tooltip {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .fsm-state-tooltip h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }
        
        .fsm-state-tooltip p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        /* FSM Diagram Controls */
        .fsm-controls {
            position: absolute;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            z-index: 10;
        }
        
        .fsm-control-btn {
            width: 36px;
            height: 36px;
            border: none;
            border-radius: 6px;
            background: var(--surface-color);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px var(--shadow-light);
        }
        
        .fsm-control-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px var(--shadow-medium);
        }
        
        /* FSM Progress Indicator */
        .fsm-progress {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
            align-items: center;
            background: var(--surface-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px var(--shadow-light);
        }
        
        .fsm-progress-step {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border-color);
            transition: all 0.3s ease;
        }
        
        .fsm-progress-step.active {
            background: var(--primary-color);
            transform: scale(1.2);
        }
        
        .fsm-progress-step.completed {
            background: #10b981;
        }
        
        .role-multipliers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .multiplier-card {
            background: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .multiplier-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        .multiplier-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .multiplier-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        
        .code-example {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            margin: 1rem 0;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .code-title {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .copy-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .copy-button:hover {
            background: var(--primary-hover);
        }
        
        /* Advanced Performance Optimization System */
        
        /* Critical CSS Inlining Classes */
        .critical-above-fold {
            /* Styles for above-the-fold content */
            contain: layout style paint;
            will-change: auto;
        }
        
        .critical-header {
            /* Optimized header for initial paint */
            contain: layout style;
            will-change: auto;
        }
        
        .critical-nav {
            /* Optimized navigation for initial interaction */
            contain: layout;
            will-change: auto;
        }
        
        /* GPU Acceleration Classes */
        .gpu-accelerated {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        
        .gpu-transform {
            will-change: transform;
            transform: translateZ(0);
        }
        
        .gpu-opacity {
            will-change: opacity;
            transform: translateZ(0);
        }
        
        .gpu-composite {
            will-change: transform, opacity;
            transform: translateZ(0);
            backface-visibility: hidden;
        }
        
        /* Performance Optimization Classes */
        .will-change-transform {
            will-change: transform;
        }
        
        .will-change-opacity {
            will-change: opacity;
        }
        
        .will-change-scroll {
            will-change: scroll-position;
        }
        
        .will-change-auto {
            will-change: auto;
        }
        
        /* Layout Containment */
        .contain-layout {
            contain: layout;
        }
        
        .contain-style {
            contain: style;
        }
        
        .contain-paint {
            contain: paint;
        }
        
        .contain-size {
            contain: size;
        }
        
        .contain-strict {
            contain: strict;
        }
        
        .contain-content {
            contain: content;
        }
        
        /* Optimized Scrolling */
        .smooth-scroll {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }
        
        .optimized-scroll {
            overflow: auto;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            scroll-snap-type: y mandatory;
        }
        
        /* Content Visibility Optimization */
        .content-auto {
            content-visibility: auto;
            contain-intrinsic-size: 1px 1000px;
        }
        
        .content-hidden {
            content-visibility: hidden;
        }
        
        .content-visible {
            content-visibility: visible;
        }
        
        /* Lazy Loading Utilities */
        .lazy-load {
            content-visibility: auto;
            contain-intrinsic-size: 0 400px;
        }
        
        .lazy-image {
            loading: lazy;
            decoding: async;
        }
        
        /* Font Loading Optimization */
        .font-display-swap {
            font-display: swap;
        }
        
        .font-display-fallback {
            font-display: fallback;
        }
        
        .font-display-optional {
            font-display: optional;
        }
        
        /* Rendering Optimizations */
        .optimize-legibility {
            text-rendering: optimizeLegibility;
        }
        
        .optimize-speed {
            text-rendering: optimizeSpeed;
        }
        
        .geometric-precision {
            text-rendering: geometricPrecision;
        }
        
        .smooth-fonts {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Image Optimization */
        .crisp-edges {
            image-rendering: crisp-edges;
            image-rendering: -webkit-optimize-contrast;
        }
        
        .smooth-images {
            image-rendering: smooth;
        }
        
        /* Memory Optimization */
        .memory-optimized {
            transform: translateZ(0);
            will-change: auto;
            contain: layout style paint;
        }
        
        /* Network Performance */
        .preload-hint {
            /* Applied to elements that should be preloaded */
        }
        
        .dns-prefetch {
            /* Applied to elements requiring DNS prefetch */
        }
        
        /* Performance Monitoring Classes */
        .perf-critical {
            /* Mark critical performance elements */
        }
        
        .perf-important {
            /* Mark important performance elements */
        }
        
        .perf-defer {
            /* Mark elements that can be deferred */
            content-visibility: auto;
        }
        
        /* Intersection Observer Optimization */
        .io-root {
            /* Intersection observer root margin optimization */
        }
        
        .io-target {
            /* Elements to be observed */
            content-visibility: auto;
            contain-intrinsic-size: 1px 200px;
        }
        
        /* Animation Performance */
        .animation-optimized {
            will-change: transform, opacity;
            backface-visibility: hidden;
            perspective: 1000px;
            transform: translateZ(0);
        }
        
        .animation-composite {
            /* Composite layer for complex animations */
            will-change: transform;
            transform: translateZ(0);
            isolation: isolate;
        }
        
        /* Resource Hints via CSS */
        .prefetch-resource::before {
            content: '';
            display: none;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg"></svg>');
        }
        
        /* Critical Path Optimization */
        .critical-path {
            /* Above-the-fold critical content */
            contain: layout style;
            will-change: auto;
        }
        
        .non-critical {
            /* Below-the-fold content */
            content-visibility: auto;
            contain-intrinsic-size: 1px 500px;
        }
        
        /* Performance Breakpoints */
        @media (max-width: 768px) {
            .mobile-optimize {
                contain: strict;
                content-visibility: auto;
            }
            
            .mobile-defer {
                content-visibility: hidden;
            }
        }
        
        @media (min-width: 1024px) {
            .desktop-optimize {
                will-change: transform;
                contain: layout;
            }
        }
        
        /* Connection-aware Performance */
        @media (prefers-reduced-data: reduce) {
            .reduce-data {
                content-visibility: auto;
                contain: strict;
            }
            
            .data-heavy {
                display: none;
            }
        }
        
        /* Battery-aware Performance */
        @media (prefers-reduced-motion: reduce) {
            .motion-heavy {
                animation: none;
                transition: none;
            }
            
            .essential-motion {
                animation-duration: 0.1s;
                transition-duration: 0.1s;
            }
        }
        
        /* Advanced Accessibility System */
        
        /* Enhanced Focus Management */
        .focus-visible:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: var(--focus-ring-offset);
            box-shadow: var(--focus-ring);
        }
        
        .focus-ring {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
            box-shadow: var(--focus-ring);
        }
        
        .focus-ring-inset {
            outline: 2px solid var(--primary-color);
            outline-offset: -2px;
        }
        
        .focus-ring-thick {
            outline: 4px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        /* High Contrast Focus */
        @media (prefers-contrast: high) {
            .focus-visible:focus-visible,
            .focus-ring:focus {
                outline-width: 3px;
                outline-color: var(--text-primary);
                box-shadow: 0 0 0 5px var(--background-color);
            }
        }
        
        /* Keyboard Navigation Support */
        .keyboard-navigation .nav-link:focus,
        .keyboard-navigation .theme-toggle:focus,
        .keyboard-navigation .copy-button:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
            box-shadow: var(--focus-ring);
        }
        
        /* Skip Links */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-color);
            color: var(--text-inverse);
            padding: 8px 12px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 1000;
            font-weight: 600;
            transition: top 0.2s ease;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        .skip-link:hover {
            background: var(--primary-hover);
        }
        
        /* Screen Reader Only Content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .sr-only-focusable:focus {
            position: static;
            width: auto;
            height: auto;
            padding: inherit;
            margin: inherit;
            overflow: visible;
            clip: auto;
            white-space: normal;
        }
        
        /* Reduced Motion Preferences */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            
            .fsm-state.active {
                animation: none;
            }
            
            .flowing-line {
                animation: none;
            }
            
            .pulse-glow {
                animation: none;
            }
            
            .smooth-scroll {
                scroll-behavior: auto;
            }
        }
        
        /* Contrast Preferences */
        @media (prefers-contrast: high) {
            :root {
                --border-color: var(--text-primary);
                --border-light: var(--text-secondary);
                --shadow-light: rgba(0, 0, 0, 0.5);
                --shadow-medium: rgba(0, 0, 0, 0.7);
            }
            
            .content-section {
                border: 2px solid var(--border-color);
            }
            
            .nav-link {
                border: 1px solid var(--border-color);
            }
            
            .theme-toggle {
                border: 2px solid var(--text-inverse);
            }
        }
        
        /* Color Scheme Preferences */
        @media (prefers-color-scheme: dark) {
            :root:not([data-theme]) {
                color-scheme: dark;
            }
        }
        
        @media (prefers-color-scheme: light) {
            :root:not([data-theme]) {
                color-scheme: light;
            }
        }
        
        /* ARIA and State Styles */
        [aria-expanded="true"] .nav-link::after {
            content: "▼";
            margin-left: 0.5em;
        }
        
        [aria-expanded="false"] .nav-link::after {
            content: "▶";
            margin-left: 0.5em;
        }
        
        [aria-current="page"] {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        [aria-hidden="true"] {
            display: none;
        }
        
        [aria-live="polite"] {
            /* Ensure live regions are properly styled */
        }
        
        [aria-live="assertive"] {
            /* Ensure assertive live regions are properly styled */
        }
        
        /* Interactive Element States */
        [aria-pressed="true"] {
            background: var(--primary-color);
            color: var(--text-inverse);
        }
        
        [aria-selected="true"] {
            background: var(--primary-light);
            color: var(--text-primary);
        }
        
        [aria-invalid="true"] {
            border-color: var(--error-color);
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);
        }
        
        [aria-disabled="true"] {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* Form Accessibility */
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--background-color);
            color: var(--text-primary);
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .form-error {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        
        .form-help {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        
        /* Button Accessibility */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            background: var(--primary-color);
            color: var(--text-inverse);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-height: 44px;
            text-decoration: none;
        }
        
        .btn:hover:not(:disabled) {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }
        
        .btn:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: var(--secondary-color);
            color: var(--text-inverse);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background: var(--secondary-600);
        }
        
        /* Link Accessibility */
        .link {
            color: var(--primary-color);
            text-decoration: underline;
            text-underline-offset: 2px;
            transition: color 0.2s ease;
        }
        
        .link:hover {
            color: var(--primary-hover);
        }
        
        .link:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
        
        /* Text Spacing for Accessibility */
        .accessible-text {
            line-height: 1.6;
            letter-spacing: 0.02em;
            word-spacing: 0.16em;
        }
        
        /* Responsive Text Sizes */
        @media (max-width: 768px) {
            .accessible-text {
                font-size: 1.125rem;
                line-height: 1.7;
            }
        }
        
        /* Animation Controls */
        .animation-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 4px 12px var(--shadow-medium);
        }
        
        .animation-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        /* Landmark Regions */
        [role="banner"] {
            /* Header landmark */
        }
        
        [role="navigation"] {
            /* Navigation landmark */
        }
        
        [role="main"] {
            /* Main content landmark */
        }
        
        [role="contentinfo"] {
            /* Footer landmark */
        }
        
        [role="search"] {
            /* Search landmark */
        }
        
        [role="complementary"] {
            /* Aside/sidebar landmark */
        }
        
        /* Advanced Interactive Components */
        
        /* Modal System */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: var(--surface-color);
            border-radius: 12px;
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            width: 500px;
            position: relative;
            box-shadow: 0 20px 40px var(--shadow-strong);
            border: 1px solid var(--border-color);
            transform: scale(0.9) translateY(20px);
            transition: all 0.3s ease;
        }
        
        .modal-overlay.open .modal {
            transform: scale(1) translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }
        
        .modal-body {
            margin-bottom: 1.5rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
        
        /* Tooltip System */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip-content {
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--surface-elevated);
            color: var(--text-primary);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            line-height: 1.4;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 1000;
            box-shadow: 0 8px 16px var(--shadow-medium);
            border: 1px solid var(--border-color);
            max-width: 200px;
            white-space: normal;
        }
        
        .tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--surface-elevated);
        }
        
        .tooltip:hover .tooltip-content,
        .tooltip:focus .tooltip-content {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-4px);
        }
        
        .tooltip-top .tooltip-content {
            bottom: 125%;
            top: auto;
        }
        
        .tooltip-bottom .tooltip-content {
            top: 125%;
            bottom: auto;
        }
        
        .tooltip-bottom .tooltip-content::after {
            top: -12px;
            border-top-color: transparent;
            border-bottom-color: var(--surface-elevated);
        }
        
        .tooltip-left .tooltip-content {
            right: 125%;
            left: auto;
            top: 50%;
            bottom: auto;
            transform: translateY(-50%);
        }
        
        .tooltip-left .tooltip-content::after {
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-left-color: var(--surface-elevated);
            border-top-color: transparent;
        }
        
        .tooltip-right .tooltip-content {
            left: 125%;
            right: auto;
            top: 50%;
            bottom: auto;
            transform: translateY(-50%);
        }
        
        .tooltip-right .tooltip-content::after {
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            border-right-color: var(--surface-elevated);
            border-top-color: transparent;
        }
        
        /* Dropdown System */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-toggle {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.75rem 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-width: 150px;
            transition: all 0.2s ease;
        }
        
        .dropdown-toggle:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 4px var(--shadow-light);
        }
        
        .dropdown-toggle::after {
            content: '▼';
            font-size: 0.75rem;
            color: var(--text-muted);
            transition: transform 0.2s ease;
        }
        
        .dropdown.open .dropdown-toggle::after {
            transform: rotate(180deg);
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--surface-elevated);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-shadow: 0 8px 16px var(--shadow-medium);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-8px);
            transition: all 0.2s ease;
            margin-top: 4px;
        }
        
        .dropdown.open .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            display: block;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.2s ease;
            border-bottom: 1px solid var(--border-light);
        }
        
        .dropdown-item:last-child {
            border-bottom: none;
        }
        
        .dropdown-item:hover {
            background: var(--primary-light);
            color: var(--primary-color);
        }
        
        /* Tab System */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-muted);
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .tab:hover {
            color: var(--text-primary);
            background: var(--border-light);
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeInUp 0.3s ease;
        }
        
        /* Accordion System */
        .accordion {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .accordion-item {
            border-bottom: 1px solid var(--border-color);
        }
        
        .accordion-item:last-child {
            border-bottom: none;
        }
        
        .accordion-header {
            background: var(--surface-color);
            padding: 1rem 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .accordion-header:hover {
            background: var(--border-light);
        }
        
        .accordion-title {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .accordion-icon {
            color: var(--text-muted);
            transition: transform 0.2s ease;
        }
        
        .accordion-item.open .accordion-icon {
            transform: rotate(180deg);
        }
        
        .accordion-content {
            padding: 0 1.5rem;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .accordion-item.open .accordion-content {
            max-height: 500px;
            padding: 1.5rem;
        }
        
        /* Progress Bar */
        .progress {
            background: var(--border-color);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-bar {
            background: var(--gradient-primary);
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .progress-large {
            height: 12px;
        }
        
        .progress-small {
            height: 4px;
        }
        
        /* Badge System */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .badge-primary {
            background: var(--primary-light);
            color: var(--primary-color);
        }
        
        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }
        
        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
        }
        
        .badge-error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
        }
        
        /* Card System */
        .card {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px var(--shadow-light);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 8px 16px var(--shadow-medium);
            transform: translateY(-2px);
        }
        
        .card-header {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .card-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .card-body {
            margin-bottom: 1rem;
        }
        
        .card-footer {
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Loading States */
        .skeleton {
            background: linear-gradient(
                90deg,
                var(--border-color) 25%,
                var(--border-light) 50%,
                var(--border-color) 75%
            );
            background-size: 200% 100%;
            animation: skeleton 1.5s infinite;
            border-radius: 4px;
        }
        
        @keyframes skeleton {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
        
        .skeleton-text {
            height: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .skeleton-title {
            height: 1.5rem;
            width: 60%;
            margin-bottom: 1rem;
        }
        
        .skeleton-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }
        
        /* Footer Styles */
        .main-footer {
            grid-area: footer;
            background: var(--surface-color);
            border-top: 1px solid var(--border-color);
            padding: 2rem;
            text-align: center;
            color: var(--text-secondary);
        }
        
        /* Advanced Responsive Design System */
        
        /* Container Queries Support (Progressive Enhancement) */
        @supports (container-type: inline-size) {
            .responsive-container {
                container-type: inline-size;
            }
            
            @container (max-width: 600px) {
                .role-multipliers-grid {
                    grid-template-columns: 1fr;
                    gap: 0.75rem;
                }
            }
            
            @container (min-width: 400px) and (max-width: 800px) {
                .role-multipliers-grid {
                    grid-template-columns: repeat(2, 1fr);
                }
            }
        }
        
        /* Granular Breakpoints */
        
        /* Extra Small Devices (Portrait Phones) */
        @media (max-width: 475px) {
            .main-header {
                padding: 0.75rem 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 0.75rem;
                text-align: center;
            }
            
            .header-title {
                font-size: 1.25rem;
            }
            
            .main-content {
                padding: 0.75rem;
            }
            
            .content-section {
                padding: 1rem;
                margin-bottom: 1.5rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .role-multipliers-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .multiplier-card {
                padding: 0.75rem;
            }
            
            .multiplier-value {
                font-size: 1.5rem;
            }
            
            .fsm-diagram-container {
                min-height: 300px;
            }
            
            .nav-list {
                padding: 0 0.75rem;
            }
            
            .nav-link {
                padding: 0.5rem 0.75rem;
                font-size: 0.9rem;
            }
        }
        
        /* Small Devices (Landscape Phones) */
        @media (min-width: 476px) and (max-width: 640px) {
            .main-content {
                padding: 1rem;
            }
            
            .content-section {
                padding: 1.25rem;
            }
            
            .role-multipliers-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .fsm-diagram-container {
                min-height: 400px;
            }
        }
        
        /* Medium Devices (Tablets) */
        @media (min-width: 641px) and (max-width: 768px) {
            .main-content {
                padding: 1.5rem;
            }
            
            .content-section {
                padding: 1.75rem;
            }
            
            .role-multipliers-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header-content {
                flex-direction: row;
                justify-content: space-between;
            }
        }
        
        /* Large Tablets (Portrait iPad) */
        @media (min-width: 769px) and (max-width: 1023px) {
            .layout-grid {
                grid-template-areas: 
                    "header header"
                    "main main"
                    "nav nav"
                    "footer footer";
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr auto auto;
            }
            
            .main-nav {
                border-right: none;
                border-top: 1px solid var(--border-color);
                padding: 1rem 0;
            }
            
            .nav-list {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                justify-content: center;
                padding: 0 1rem;
            }
            
            .nav-item {
                margin-bottom: 0;
            }
            
            .nav-link {
                padding: 0.5rem 1rem;
                border-radius: 20px;
            }
            
            .nav-section-title {
                display: none;
            }
            
            .role-multipliers-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        /* Desktop and Large Screens */
        @media (min-width: 1024px) {
            .main-content {
                padding: 2rem;
            }
            
            .role-multipliers-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        /* Large Desktop */
        @media (min-width: 1280px) {
            .layout-grid {
                grid-template-columns: 320px 1fr;
            }
            
            .main-content {
                padding: 2.5rem;
                max-width: 1400px;
            }
            
            .content-section {
                padding: 2.5rem;
            }
        }
        
        /* Ultra Wide Screens */
        @media (min-width: 1536px) {
            .layout-grid {
                grid-template-columns: 360px 1fr;
            }
            
            .main-content {
                padding: 3rem;
                max-width: 1600px;
            }
        }
        
        /* Orientation-based Responsive Rules */
        @media (orientation: landscape) and (max-height: 600px) {
            .main-header {
                padding: 0.5rem 1rem;
            }
            
            .header-title {
                font-size: 1.25rem;
            }
            
            .header-subtitle {
                display: none;
            }
            
            .fsm-diagram-container {
                min-height: 250px;
            }
        }
        
        /* High DPI Displays */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .logo {
                font-size: 1.1rem;
            }
            
            .fsm-state {
                box-shadow: 0 2px 6px var(--shadow-light);
            }
        }
        
        /* Pointer and Interaction Media Queries */
        @media (hover: hover) and (pointer: fine) {
            .multiplier-card:hover {
                transform: translateY(-4px);
            }
            
            .fsm-state:hover {
                transform: scale(1.15) translateZ(0);
            }
        }
        
        @media (hover: none) and (pointer: coarse) {
            .hover-lift:hover,
            .hover-scale:hover,
            .hover-glow:hover {
                transform: none;
                box-shadow: none;
            }
            
            .nav-link:hover {
                transform: none;
            }
            
            /* Larger touch targets for mobile */
            .nav-link {
                min-height: 44px;
                display: flex;
                align-items: center;
            }
            
            .theme-toggle {
                min-height: 44px;
                min-width: 44px;
            }
            
            .copy-button {
                min-height: 44px;
                padding: 0.5rem 1rem;
            }
        }
        
        /* Print Styles */
        @media print {
            .main-header,
            .main-nav,
            .main-footer,
            .theme-toggle,
            .copy-button,
            .fsm-controls {
                display: none;
            }
            
            .layout-grid {
                display: block;
            }
            
            .main-content {
                padding: 0;
                margin: 0;
                max-width: none;
            }
            
            .content-section {
                break-inside: avoid;
                page-break-inside: avoid;
                margin-bottom: 1rem;
                box-shadow: none;
                border: 1px solid #ccc;
            }
            
            .fsm-diagram-container {
                border: 2px solid #333;
            }
            
            /* Force light theme colors for print */
            * {
                background: white !important;
                color: black !important;
                box-shadow: none !important;
            }
            
            .code-example {
                background: #f5f5f5 !important;
                border: 1px solid #ccc;
            }
        }
        
        /* Reduced Data Mode */
        @media (prefers-reduced-data: reduce) {
            .gradient-primary,
            .gradient-secondary,
            .gradient-accent {
                background: var(--primary-color);
            }
            
            .shimmer {
                animation: none;
                background: var(--surface-color);
            }
        }
        
        /* Advanced Animation System */
        
        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Base Animation Classes */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }
        
        .fade-in-down {
            animation: fadeInDown 0.6s ease-out;
        }
        
        .fade-in-left {
            animation: fadeInLeft 0.6s ease-out;
        }
        
        .fade-in-right {
            animation: fadeInRight 0.6s ease-out;
        }
        
        .slide-in {
            animation: slideIn 0.8s ease-out;
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        .zoom-in {
            animation: zoomIn 0.4s ease-out;
        }
        
        .bounce-in {
            animation: bounceIn 0.8s ease-out;
        }
        
        .scale-up {
            animation: scaleUp 0.3s ease-out;
        }
        
        /* Staggered Animation Classes */
        .stagger-children > * {
            opacity: 0;
            animation: staggeredFadeIn 0.6s ease-out forwards;
        }
        
        .stagger-children > *:nth-child(1) { animation-delay: 0.1s; }
        .stagger-children > *:nth-child(2) { animation-delay: 0.2s; }
        .stagger-children > *:nth-child(3) { animation-delay: 0.3s; }
        .stagger-children > *:nth-child(4) { animation-delay: 0.4s; }
        .stagger-children > *:nth-child(5) { animation-delay: 0.5s; }
        .stagger-children > *:nth-child(6) { animation-delay: 0.6s; }
        
        /* Micro-interaction Classes */
        .hover-lift {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px var(--shadow-medium);
        }
        
        .hover-glow {
            transition: box-shadow 0.3s ease;
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 20px rgba(37, 99, 235, 0.3);
        }
        
        .hover-scale {
            transition: transform 0.2s ease;
        }
        
        .hover-scale:hover {
            transform: scale(1.05);
        }
        
        .hover-rotate {
            transition: transform 0.3s ease;
        }
        
        .hover-rotate:hover {
            transform: rotate(5deg);
        }
        
        .ripple-effect {
            position: relative;
            overflow: hidden;
        }
        
        .ripple-effect::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .ripple-effect:active::after {
            width: 300px;
            height: 300px;
        }
        
        /* Loading and Progress Animations */
        .spinning {
            animation: spin 1s linear infinite;
        }
        
        .pulsing {
            animation: pulse 2s infinite;
        }
        
        .breathing {
            animation: breathe 3s ease-in-out infinite;
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        .shimmer {
            background: linear-gradient(
                90deg,
                var(--surface-color) 0%,
                var(--border-color) 50%,
                var(--surface-color) 100%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        /* Complex Animation Keyframes */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }
        
        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                transform: scale(1.1);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes scaleUp {
            from {
                transform: scale(0.95);
            }
            to {
                transform: scale(1);
            }
        }
        
        @keyframes staggeredFadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }
        
        @keyframes breathe {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }
        
        /* Entrance Animation Utilities */
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease-out;
        }
        
        .animate-on-scroll.in-view {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Performance Optimization for Animations */
        .animation-optimized {
            will-change: transform, opacity;
            backface-visibility: hidden;
            perspective: 1000px;
        }

        /* ==========================================
           INTERACTIVE COMPONENT STYLES
           ========================================== */

        /* Performance Metrics Styles */
        .performance-metrics {
            display: flex;
            gap: 1rem;
            align-items: center;
            font-size: 0.85rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            backdrop-filter: blur(10px);
        }

        .performance-metrics .metric-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .performance-metrics .metric-label {
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .performance-metrics .metric-value {
            color: var(--accent-color);
            font-weight: 600;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* FSM Status Container Styles */
        .fsm-status-container {
            margin-top: 1.5rem;
            padding: 1rem;
            background: var(--surface-elevated);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-light);
        }

        .fsm-status-message {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .fsm-status-message strong {
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .state-description {
            color: var(--text-secondary);
            font-style: italic;
            font-size: 0.95rem;
            padding-left: 1rem;
            border-left: 3px solid var(--primary-color);
        }

        /* Cognitive Enhancement Demo Styles */
        .cognitive-demo-wrapper {
            margin-top: 1.5rem;
            padding: 2rem;
            background: var(--surface-elevated);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            box-shadow: 0 4px 16px var(--shadow-light);
        }

        .cognitive-demo-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .role-selector-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .role-selector {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--background-color);
            color: var(--text-primary);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .role-selector:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        .role-selector:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        .multiplier-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--surface-color) 0%, var(--surface-elevated) 100%);
            border-radius: 12px;
            border: 1px solid var(--border-light);
        }

        .multiplier-card {
            flex: 1;
            text-align: center;
            padding: 1.5rem;
            background: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            box-shadow: 0 2px 8px var(--shadow-light);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .multiplier-card.enhanced {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--background-color) 100%);
            border-color: var(--primary-color);
        }

        .multiplier-card h4 {
            margin: 0 0 1rem 0;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .efficiency-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin: 0.75rem 0;
        }

        .efficiency-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .efficiency-fill.base {
            background: linear-gradient(90deg, var(--secondary-color) 0%, var(--secondary-hover) 100%);
        }

        .efficiency-fill.enhanced {
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--accent-color) 100%);
        }

        .efficiency-value {
            display: inline-block;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-primary);
        }

        .multiplier-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .multiplier-arrow {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-secondary);
            padding: 0 0.5rem;
        }

        .cognitive-metrics {
            margin-top: 1.5rem;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .metric-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--surface-color);
            border: 1px solid var(--border-light);
            border-radius: 8px;
        }

        .metric-label {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .metric-progress {
            width: 100%;
            height: 10px;
            background: var(--border-color);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color) 0%, var(--primary-color) 100%);
            border-radius: 5px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: left;
        }

        .metric-value {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1.1rem;
        }

        /* Expandable Sections Styles */
        .expand-indicator {
            font-size: 1.2rem;
            color: var(--text-muted);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), color 0.3s ease;
            cursor: pointer;
        }

        .section-header:hover .expand-indicator {
            color: var(--primary-color);
            transform: translateY(-50%) scale(1.1);
        }

        [data-expandable="true"] .section-header:hover {
            background: var(--surface-color);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            margin: -0.5rem -1rem;
        }

        /* Enhanced Navigation Progress Bar */
        .nav-progress-bar {
            position: absolute;
            right: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: var(--border-light);
        }

        .nav-progress-fill {
            width: 100%;
            height: 0%;
            background: linear-gradient(180deg, var(--primary-color) 0%, var(--accent-color) 100%);
            transition: height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 2px;
        }

        /* Enhanced Theme Toggle Styles */
        .theme-icon {
            display: inline-block;
            margin-right: 0.5rem;
            font-size: 1.1rem;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover .theme-icon {
            transform: scale(1.2) rotate(15deg);
        }

        .theme-text {
            font-weight: 500;
        }

        /* FSM SVG Enhancements */
        .fsm-state-group {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .fsm-state-group:hover {
            transform-origin: center;
        }

        .fsm-transition {
            transition: all 0.3s ease;
        }

        .fsm-transition:hover {
            stroke: var(--primary-color);
            stroke-width: 3;
        }

        /* Responsive Adjustments for Interactive Components */
        @media (max-width: 768px) {
            .performance-metrics {
                flex-direction: column;
                gap: 0.5rem;
                padding: 0.75rem;
            }

            .header-controls {
                flex-direction: column;
                align-items: stretch;
                gap: 0.75rem;
            }

            .multiplier-display {
                flex-direction: column;
                gap: 1.5rem;
            }

            .multiplier-arrow {
                transform: rotate(90deg);
                font-size: 1.2rem;
            }

            .metric-grid {
                grid-template-columns: 1fr;
            }

            .cognitive-demo-wrapper {
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            .performance-metrics {
                font-size: 0.75rem;
            }

            .multiplier-card {
                padding: 1rem;
            }

            .multiplier-value {
                font-size: 1.5rem;
            }

            .role-selector-container {
                flex-direction: column;
                align-items: stretch;
                gap: 0.5rem;
            }
        }

        /* Animation Keyframes */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .pulse-animation {
            animation: pulse 2s infinite ease-in-out;
        }

        /* Dark Theme Adjustments for Interactive Components */
        [data-theme="dark"] .performance-metrics {
            background: rgba(0, 0, 0, 0.3);
        }

        [data-theme="dark"] .cognitive-demo-wrapper,
        [data-theme="dark"] .fsm-status-container {
            background: var(--surface-elevated);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .multiplier-display {
            background: linear-gradient(135deg, var(--surface-elevated) 0%, var(--surface-color) 100%);
        }

        [data-theme="dark"] .multiplier-card.enhanced {
            background: linear-gradient(135deg, var(--primary-900) 0%, var(--surface-elevated) 100%);
        }

        /* High Contrast Mode Support */
        @media (prefers-contrast: high) {
            .multiplier-card,
            .cognitive-demo-wrapper,
            .fsm-status-container {
                border-width: 2px;
            }

            .progress-bar,
            .efficiency-fill {
                border: 1px solid var(--text-primary);
            }
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            .fsm-state-group,
            .multiplier-card,
            .progress-bar,
            .efficiency-fill,
            .nav-progress-fill {
                transition: none;
            }

            .pulse-animation {
                animation: none;
            }
        }
    </style>
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Main Layout Grid -->
    <div class="layout-grid">
        <!-- Header -->
        <header class="main-header" role="banner">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo" aria-label="Manus Logo">M</div>
                    <div>
                        <h1 class="header-title">Manus FSM Orchestrator</h1>
                        <p class="header-subtitle">Claude Code CLI Architecture</p>
                    </div>
                </div>
                <div class="header-controls">
                    <!-- Performance Metrics Display -->
                    <div id="performance-metrics" class="performance-metrics">
                        <div class="metric-item">
                            <span class="metric-label">Load Time:</span>
                            <span class="metric-value">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Cognitive Boost:</span>
                            <span class="metric-value">2.5x</span>
                        </div>
                    </div>
                    
                    <button class="theme-toggle focus-visible" 
                            id="theme-toggle" 
                            aria-label="Toggle dark/light theme"
                            type="button">
                        🌙 Dark Mode
                    </button>
                </div>
            </div>
        </header>
        
        <!-- Navigation -->
        <nav class="main-nav" role="navigation" aria-label="Main navigation">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="#overview" class="nav-link active focus-visible">Overview</a>
                </li>
                <li class="nav-item">
                    <a href="#fsm-architecture" class="nav-link focus-visible">FSM Architecture</a>
                </li>
                <li class="nav-item">
                    <a href="#cognitive-enhancement" class="nav-link focus-visible">Cognitive Enhancement</a>
                </li>
                <li class="nav-item">
                    <a href="#role-multipliers" class="nav-link focus-visible">Role Multipliers</a>
                </li>
                
                <div class="nav-section-title">Implementation</div>
                <li class="nav-item">
                    <a href="#code-examples" class="nav-link focus-visible">Code Examples</a>
                </li>
                <li class="nav-item">
                    <a href="#api-integration" class="nav-link focus-visible">API Integration</a>
                </li>
                <li class="nav-item">
                    <a href="#testing-strategy" class="nav-link focus-visible">Testing Strategy</a>
                </li>
                
                <div class="nav-section-title">Advanced</div>
                <li class="nav-item">
                    <a href="#performance" class="nav-link focus-visible">Performance</a>
                </li>
                <li class="nav-item">
                    <a href="#troubleshooting" class="nav-link focus-visible">Troubleshooting</a>
                </li>
                <li class="nav-item">
                    <a href="#best-practices" class="nav-link focus-visible">Best Practices</a>
                </li>
            </ul>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content" id="main-content" role="main">
            <!-- Overview Section -->
            <section id="overview" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">System Overview</h2>
                    <p class="section-subtitle">
                        Comprehensive architecture walkthrough of the Manus FSM Orchestrator, 
                        featuring 6-step agent loop with cognitive enhancement and role-based multipliers.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Architecture Highlights</h3>
                    <div class="role-multipliers-grid">
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">6</div>
                            <div class="multiplier-label">Step Agent Loop</div>
                        </div>
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">3</div>
                            <div class="multiplier-label">Core Modules</div>
                        </div>
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">3.2x</div>
                            <div class="multiplier-label">Max Enhancement</div>
                        </div>
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">∞</div>
                            <div class="multiplier-label">Fractal Depth</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- FSM Architecture Section -->
            <section id="fsm-architecture" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">FSM Architecture</h2>
                    <p class="section-subtitle">
                        Interactive finite state machine diagram showing the 6-step orchestration loop
                        and module interactions.
                    </p>
                </header>
                
                <div class="fsm-diagram-container gpu-accelerated" 
                     role="img" 
                     aria-label="FSM Architecture Diagram">
                    <div class="diagram-placeholder">
                        <h3>Interactive FSM Diagram</h3>
                        <p>Diagram will be rendered here with D3.js or similar visualization library</p>
                        <p>Shows: Analyze Events → Select Tools → Wait → Iterate → Submit → Standby</p>
                    </div>
                </div>
                
                <div class="interactive-container">
                    <h3>State Transitions</h3>
                    <p>Click on states in the diagram above to see detailed information about each phase 
                       of the orchestration loop and module interactions.</p>
                    
                    <!-- FSM Status Display -->
                    <div id="fsm-status" class="fsm-status-container">
                        <div class="fsm-status-message">
                            <strong>Current State:</strong> Ready to initialize
                            <div class="state-description">
                                Interactive FSM diagram loading...
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Cognitive Enhancement Section -->
            <section id="cognitive-enhancement" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Cognitive Enhancement</h2>
                    <p class="section-subtitle">
                        Role-based cognitive multipliers that enhance reasoning effectiveness 
                        through systematic thinking frameworks.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Enhancement Frameworks</h3>
                    <div class="role-multipliers-grid">
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">2.3x</div>
                            <div class="multiplier-label">Base Enhancement</div>
                        </div>
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">2.5x</div>
                            <div class="multiplier-label">Coder Role</div>
                        </div>
                        <div class="multiplier-card will-change-transform">
                            <div class="multiplier-value">3.2x</div>
                            <div class="multiplier-label">Expert Domain</div>
                        </div>
                    </div>
                    
                    <!-- Interactive Cognitive Enhancement Demo -->
                    <h3>Interactive Multiplier Demonstration</h3>
                    <div id="cognitive-demo" class="cognitive-demo-wrapper">
                        <!-- Dynamic content will be generated by JavaScript -->
                        <p>Loading interactive cognitive enhancement demonstration...</p>
                    </div>
                </div>
            </section>
            
            <!-- Role Multipliers Section -->
            <section id="role-multipliers" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Role Multipliers</h2>
                    <p class="section-subtitle">
                        Dynamic role-based performance multipliers that adapt cognitive 
                        enhancement based on task requirements and expertise domains.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <div class="code-header">
                        <h3 class="code-title">Role Multiplier Configuration</h3>
                        <button class="copy-button focus-visible" 
                                aria-label="Copy code to clipboard">
                            Copy
                        </button>
                    </div>
                    <div class="code-example">
                        <pre><code>// Role-based cognitive enhancement multipliers
const roleMultipliers = {
  coder: {
    base: 2.5,
    frameworks: {
      test_driven_development: 0.3,
      modular_architecture: 0.4,
      error_handling: 0.2
    }
  },
  expert: {
    base: 3.2,
    domain_depth: 0.5,
    systematic_thinking: 0.4
  },
  analyst: {
    base: 2.3,
    pattern_recognition: 0.3,
    data_synthesis: 0.4
  }
};</code></pre>
                    </div>
                </div>
            </section>
            
            <!-- Code Examples Section -->
            <section id="code-examples" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Code Examples</h2>
                    <p class="section-subtitle">
                        Practical implementation examples showing how to integrate and use 
                        the Manus FSM Orchestrator in your projects.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <div class="code-header">
                        <h3 class="code-title">Basic Orchestrator Usage</h3>
                        <button class="copy-button focus-visible" 
                                aria-label="Copy code to clipboard">
                            Copy
                        </button>
                    </div>
                    <div class="code-example">
                        <pre><code>// Initialize Manus FSM Orchestrator
const orchestrator = new ManusOrchestrator({
  sessionId: 'session-123',
  initialObjective: 'Implement user authentication system',
  cognitiveEnhancement: {
    role: 'coder',
    multiplier: 2.5,
    frameworks: ['test_driven_development', 'modular_architecture']
  }
});

// Execute orchestration loop
const result = await orchestrator.orchestrate({
  phase: 'QUERY',
  payload: {
    userRequest: 'Create login and registration forms',
    context: { technology: 'React', testing: 'Jest' }
  }
});

console.log('Orchestration result:', result);</code></pre>
                    </div>
                </div>
            </section>
            
            <!-- API Integration Section -->
            <section id="api-integration" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">API Integration</h2>
                    <p class="section-subtitle">
                        Integration patterns and API endpoints for connecting the Manus FSM 
                        Orchestrator with external systems and services.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Integration Endpoints</h3>
                    <p>Documentation for MCP server integration, Claude Code CLI hooks, 
                       and external service connections.</p>
                </div>
            </section>
            
            <!-- Testing Strategy Section -->
            <section id="testing-strategy" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Testing Strategy</h2>
                    <p class="section-subtitle">
                        Comprehensive testing approach for FSM state transitions, 
                        cognitive enhancement validation, and integration testing.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Test Coverage Areas</h3>
                    <ul>
                        <li>FSM state transition validation</li>
                        <li>Cognitive enhancement multiplier accuracy</li>
                        <li>Role-based framework application</li>
                        <li>Integration with MCP protocol</li>
                        <li>Performance and scalability testing</li>
                    </ul>
                </div>
            </section>
            
            <!-- Performance Section -->
            <section id="performance" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Performance Optimization</h2>
                    <p class="section-subtitle">
                        Performance characteristics, optimization strategies, and monitoring 
                        approaches for the FSM orchestrator.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Performance Metrics</h3>
                    <p>Real-time performance monitoring and optimization recommendations 
                       will be displayed here.</p>
                </div>
            </section>
            
            <!-- Troubleshooting Section -->
            <section id="troubleshooting" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Troubleshooting</h2>
                    <p class="section-subtitle">
                        Common issues, debugging strategies, and diagnostic tools for 
                        the Manus FSM Orchestrator.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Diagnostic Tools</h3>
                    <p>Interactive debugging interface and diagnostic utilities 
                       for troubleshooting FSM orchestration issues.</p>
                </div>
            </section>
            
            <!-- Best Practices Section -->
            <section id="best-practices" class="content-section fade-in">
                <header class="section-header">
                    <h2 class="section-title">Best Practices</h2>
                    <p class="section-subtitle">
                        Recommended patterns, conventions, and implementation guidelines 
                        for optimal use of the Manus FSM Orchestrator.
                    </p>
                </header>
                
                <div class="interactive-container">
                    <h3>Implementation Guidelines</h3>
                    <ul>
                        <li>Use systematic task breakdown with TodoWrite</li>
                        <li>Apply appropriate cognitive enhancement multipliers</li>
                        <li>Follow test-driven development patterns</li>
                        <li>Implement proper error handling and validation</li>
                        <li>Maintain modular architecture principles</li>
                    </ul>
                </div>
            </section>
        </main>
        
        <!-- Footer -->
        <footer class="main-footer" role="contentinfo">
            <p>&copy; 2024 Manus Team. Enhanced architecture walkthrough with 2.5x cognitive multipliers.</p>
            <p>Built with semantic HTML5, accessibility best practices, and performance optimization.</p>
        </footer>
    </div>
    
    <!-- Enhanced JavaScript for Comprehensive Interactivity -->
    <script>
        /**
         * MANUS FSM ORCHESTRATOR - INTERACTIVE ARCHITECTURE WALKTHROUGH
         * Enhanced with 2.5x cognitive enhancement for systematic implementation
         * Modular architecture with comprehensive interactive features
         */

        // ==========================================
        // CORE SYSTEM MODULES
        // ==========================================

        /**
         * Performance Monitoring Module
         * Real-time performance tracking and display
         */
        const PerformanceTracker = {
            metrics: {
                pageLoadTime: 0,
                interactionLatency: [],
                memoryUsage: 0,
                renderFrames: 0,
                cognitiveMultiplier: 2.5
            },
            
            init() {
                this.trackPageLoad();
                this.trackMemoryUsage();
                this.trackInteractionLatency();
                this.displayMetrics();
                setInterval(() => this.updateMetrics(), 1000);
            },
            
            trackPageLoad() {
                if ('performance' in window) {
                    window.addEventListener('load', () => {
                        setTimeout(() => {
                            const perfData = performance.getEntriesByType('navigation')[0];
                            this.metrics.pageLoadTime = Math.round(perfData.loadEventEnd - perfData.loadEventStart);
                            console.log(`🚀 Page loaded in ${this.metrics.pageLoadTime}ms`);
                            this.displayMetrics();
                        }, 100);
                    });
                }
            },
            
            trackMemoryUsage() {
                if ('memory' in performance) {
                    setInterval(() => {
                        this.metrics.memoryUsage = Math.round(performance.memory.usedJSHeapSize / 1024 / 1024);
                    }, 2000);
                }
            },
            
            trackInteractionLatency() {
                document.addEventListener('click', (e) => {
                    const startTime = performance.now();
                    requestAnimationFrame(() => {
                        const latency = Math.round(performance.now() - startTime);
                        this.metrics.interactionLatency.push(latency);
                        if (this.metrics.interactionLatency.length > 10) {
                            this.metrics.interactionLatency.shift();
                        }
                    });
                });
            },
            
            updateMetrics() {
                this.metrics.renderFrames++;
                this.displayMetrics();
            },
            
            displayMetrics() {
                const perfContainer = document.getElementById('performance-metrics');
                if (perfContainer) {
                    const avgLatency = this.metrics.interactionLatency.length > 0 
                        ? Math.round(this.metrics.interactionLatency.reduce((a, b) => a + b, 0) / this.metrics.interactionLatency.length)
                        : 0;
                    
                    perfContainer.innerHTML = `
                        <div class="metric-item">
                            <span class="metric-label">Load Time:</span>
                            <span class="metric-value">${this.metrics.pageLoadTime}ms</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Memory:</span>
                            <span class="metric-value">${this.metrics.memoryUsage}MB</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Latency:</span>
                            <span class="metric-value">${avgLatency}ms</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Cognitive Boost:</span>
                            <span class="metric-value">${this.metrics.cognitiveMultiplier}x</span>
                        </div>
                    `;
                }
            }
        };

        /**
         * FSM Diagram Interactive Module
         * Creates clickable state transitions and visual feedback
         */
        const FSMDiagram = {
            states: [
                { id: 'analyze', name: 'Analyze Events', x: 150, y: 100, color: '#3b82f6' },
                { id: 'select', name: 'Select Tools', x: 350, y: 100, color: '#10b981' },
                { id: 'wait', name: 'Wait Execution', x: 550, y: 100, color: '#f59e0b' },
                { id: 'iterate', name: 'Iterate', x: 550, y: 250, color: '#ef4444' },
                { id: 'submit', name: 'Submit Results', x: 350, y: 250, color: '#8b5cf6' },
                { id: 'standby', name: 'Enter Standby', x: 150, y: 250, color: '#64748b' }
            ],
            
            transitions: [
                { from: 'analyze', to: 'select', label: 'Events Processed' },
                { from: 'select', to: 'wait', label: 'Tools Selected' },
                { from: 'wait', to: 'iterate', label: 'Results Ready' },
                { from: 'iterate', to: 'submit', label: 'Iteration Complete' },
                { from: 'submit', to: 'standby', label: 'Results Submitted' },
                { from: 'standby', to: 'analyze', label: 'New Events' },
                { from: 'iterate', to: 'select', label: 'Need More Tools' }
            ],
            
            currentState: 'analyze',
            animationRunning: false,
            
            init() {
                this.createDiagram();
                this.bindEvents();
                this.startDemoAnimation();
            },
            
            createDiagram() {
                const container = document.querySelector('.fsm-diagram-container');
                if (!container) return;
                
                // Clear existing content
                container.innerHTML = '';
                
                // Create SVG canvas
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('width', '700');
                svg.setAttribute('height', '350');
                svg.setAttribute('viewBox', '0 0 700 350');
                svg.style.width = '100%';
                svg.style.height = '100%';
                
                // Add states
                this.states.forEach(state => {
                    const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                    group.setAttribute('class', 'fsm-state-group');
                    group.setAttribute('data-state', state.id);
                    group.style.cursor = 'pointer';
                    
                    // State circle
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', state.x);
                    circle.setAttribute('cy', state.y);
                    circle.setAttribute('r', '40');
                    circle.setAttribute('fill', state.color);
                    circle.setAttribute('stroke', '#ffffff');
                    circle.setAttribute('stroke-width', '3');
                    circle.setAttribute('class', 'fsm-state-circle');
                    
                    // State label
                    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    text.setAttribute('x', state.x);
                    text.setAttribute('y', state.y + 5);
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('fill', '#ffffff');
                    text.setAttribute('font-size', '12');
                    text.setAttribute('font-weight', 'bold');
                    text.textContent = state.name.split(' ')[0];
                    
                    group.appendChild(circle);
                    group.appendChild(text);
                    svg.appendChild(group);
                });
                
                // Add transitions
                this.transitions.forEach(transition => {
                    const fromState = this.states.find(s => s.id === transition.from);
                    const toState = this.states.find(s => s.id === transition.to);
                    
                    if (fromState && toState) {
                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', fromState.x);
                        line.setAttribute('y1', fromState.y);
                        line.setAttribute('x2', toState.x);
                        line.setAttribute('y2', toState.y);
                        line.setAttribute('stroke', '#64748b');
                        line.setAttribute('stroke-width', '2');
                        line.setAttribute('stroke-dasharray', '5,5');
                        line.setAttribute('class', 'fsm-transition');
                        line.setAttribute('data-from', transition.from);
                        line.setAttribute('data-to', transition.to);
                        
                        svg.insertBefore(line, svg.firstChild);
                    }
                });
                
                container.appendChild(svg);
                this.highlightCurrentState();
            },
            
            bindEvents() {
                document.querySelectorAll('.fsm-state-group').forEach(group => {
                    group.addEventListener('click', (e) => {
                        const stateId = group.getAttribute('data-state');
                        this.transitionToState(stateId);
                    });
                    
                    group.addEventListener('mouseenter', (e) => {
                        const circle = group.querySelector('.fsm-state-circle');
                        circle.setAttribute('stroke-width', '5');
                        group.style.transform = 'scale(1.1)';
                        group.style.transformOrigin = 'center';
                    });
                    
                    group.addEventListener('mouseleave', (e) => {
                        const circle = group.querySelector('.fsm-state-circle');
                        circle.setAttribute('stroke-width', '3');
                        group.style.transform = 'scale(1)';
                    });
                });
            },
            
            transitionToState(newState) {
                const validTransition = this.transitions.some(t => 
                    t.from === this.currentState && t.to === newState
                );
                
                if (validTransition || newState === this.currentState) {
                    this.currentState = newState;
                    this.highlightCurrentState();
                    this.showTransitionMessage(newState);
                }
            },
            
            highlightCurrentState() {
                document.querySelectorAll('.fsm-state-group').forEach(group => {
                    const circle = group.querySelector('.fsm-state-circle');
                    const isActive = group.getAttribute('data-state') === this.currentState;
                    
                    circle.setAttribute('stroke', isActive ? '#fbbf24' : '#ffffff');
                    circle.setAttribute('stroke-width', isActive ? '4' : '3');
                    
                    if (isActive) {
                        group.style.filter = 'drop-shadow(0 0 10px #fbbf24)';
                    } else {
                        group.style.filter = 'none';
                    }
                });
            },
            
            showTransitionMessage(state) {
                const stateInfo = this.states.find(s => s.id === state);
                const messageContainer = document.getElementById('fsm-status');
                if (messageContainer && stateInfo) {
                    messageContainer.innerHTML = `
                        <div class="fsm-status-message">
                            <strong>Current State:</strong> ${stateInfo.name}
                            <div class="state-description">
                                ${this.getStateDescription(state)}
                            </div>
                        </div>
                    `;
                }
            },
            
            getStateDescription(stateId) {
                const descriptions = {
                    analyze: 'Processing incoming events and determining required actions.',
                    select: 'Choosing appropriate tools and resources for task execution.',
                    wait: 'Waiting for tool execution to complete and gather results.',
                    iterate: 'Evaluating results and determining if iteration is needed.',
                    submit: 'Finalizing and submitting completed results to user.',
                    standby: 'Idle state, monitoring for new events and requests.'
                };
                return descriptions[stateId] || 'State description not available.';
            },
            
            startDemoAnimation() {
                if (this.animationRunning) return;
                this.animationRunning = true;
                
                const stateSequence = ['analyze', 'select', 'wait', 'iterate', 'submit', 'standby'];
                let currentIndex = 0;
                
                const animate = () => {
                    if (!this.animationRunning) return;
                    
                    this.transitionToState(stateSequence[currentIndex]);
                    currentIndex = (currentIndex + 1) % stateSequence.length;
                    
                    setTimeout(animate, 2000);
                };
                
                setTimeout(animate, 1000);
            },
            
            stopDemoAnimation() {
                this.animationRunning = false;
            }
        };

        /**
         * Cognitive Enhancement Demonstration Module
         * Live multiplier calculations and demonstrations
         */
        const CognitiveEnhancement = {
            multipliers: {
                'coder': 2.3,
                'architect': 2.8,
                'analyst': 2.5,
                'researcher': 3.2,
                'planner': 2.6
            },
            
            currentRole: 'coder',
            baseEfficiency: 100,
            
            init() {
                this.createMultiplierDemo();
                this.createRoleSelector();
                this.updateDisplays();
                this.startLiveDemo();
            },
            
            createMultiplierDemo() {
                const container = document.getElementById('cognitive-demo');
                if (!container) return;
                
                container.innerHTML = `
                    <div class="cognitive-demo-container">
                        <div class="role-selector-container">
                            <label for="role-selector">Select Role:</label>
                            <select id="role-selector" class="role-selector">
                                ${Object.keys(this.multipliers).map(role => 
                                    `<option value="${role}" ${role === this.currentRole ? 'selected' : ''}>
                                        ${role.charAt(0).toUpperCase() + role.slice(1)}
                                    </option>`
                                ).join('')}
                            </select>
                        </div>
                        
                        <div class="multiplier-display">
                            <div class="multiplier-card">
                                <h4>Base Efficiency</h4>
                                <div class="efficiency-bar">
                                    <div class="efficiency-fill base" style="width: 100%"></div>
                                </div>
                                <span class="efficiency-value">${this.baseEfficiency}%</span>
                            </div>
                            
                            <div class="multiplier-arrow">×</div>
                            
                            <div class="multiplier-card">
                                <h4>Cognitive Multiplier</h4>
                                <div class="multiplier-value" id="current-multiplier">
                                    ${this.multipliers[this.currentRole]}x
                                </div>
                            </div>
                            
                            <div class="multiplier-arrow">=</div>
                            
                            <div class="multiplier-card enhanced">
                                <h4>Enhanced Efficiency</h4>
                                <div class="efficiency-bar">
                                    <div class="efficiency-fill enhanced" id="enhanced-fill"></div>
                                </div>
                                <span class="efficiency-value" id="enhanced-value"></span>
                            </div>
                        </div>
                        
                        <div class="cognitive-metrics">
                            <div class="metric-grid">
                                <div class="metric-item">
                                    <span class="metric-label">Problem Solving:</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar" id="problem-solving-bar"></div>
                                    </div>
                                    <span class="metric-value" id="problem-solving-value"></span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Code Quality:</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar" id="code-quality-bar"></div>
                                    </div>
                                    <span class="metric-value" id="code-quality-value"></span>
                                </div>
                                <div class="metric-item">
                                    <span class="metric-label">Task Completion:</span>
                                    <div class="metric-progress">
                                        <div class="progress-bar" id="task-completion-bar"></div>
                                    </div>
                                    <span class="metric-value" id="task-completion-value"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },
            
            createRoleSelector() {
                const selector = document.getElementById('role-selector');
                if (selector) {
                    selector.addEventListener('change', (e) => {
                        this.currentRole = e.target.value;
                        this.updateDisplays();
                        this.animateTransition();
                    });
                }
            },
            
            updateDisplays() {
                const multiplier = this.multipliers[this.currentRole];
                const enhancedEfficiency = this.baseEfficiency * multiplier;
                
                // Update multiplier display
                const multiplierEl = document.getElementById('current-multiplier');
                if (multiplierEl) multiplierEl.textContent = `${multiplier}x`;
                
                // Update enhanced efficiency
                const enhancedValueEl = document.getElementById('enhanced-value');
                const enhancedFillEl = document.getElementById('enhanced-fill');
                if (enhancedValueEl) enhancedValueEl.textContent = `${Math.round(enhancedEfficiency)}%`;
                if (enhancedFillEl) {
                    const percentage = Math.min(enhancedEfficiency / 3, 100);
                    enhancedFillEl.style.width = `${percentage}%`;
                }
                
                // Update cognitive metrics
                this.updateCognitiveMetrics(multiplier);
            },
            
            updateCognitiveMetrics(multiplier) {
                const metrics = {
                    'problem-solving': Math.round(85 * multiplier),
                    'code-quality': Math.round(78 * multiplier),
                    'task-completion': Math.round(92 * multiplier)
                };
                
                Object.entries(metrics).forEach(([metric, value]) => {
                    const barEl = document.getElementById(`${metric}-bar`);
                    const valueEl = document.getElementById(`${metric}-value`);
                    
                    if (barEl) barEl.style.width = `${Math.min(value, 100)}%`;
                    if (valueEl) valueEl.textContent = `${value}%`;
                });
            },
            
            animateTransition() {
                const multiplierCard = document.querySelector('.multiplier-card.enhanced');
                if (multiplierCard) {
                    multiplierCard.style.transform = 'scale(1.05)';
                    multiplierCard.style.boxShadow = '0 8px 24px rgba(59, 130, 246, 0.3)';
                    
                    setTimeout(() => {
                        multiplierCard.style.transform = 'scale(1)';
                        multiplierCard.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.1)';
                    }, 300);
                }
            },
            
            startLiveDemo() {
                setInterval(() => {
                    // Simulate live cognitive enhancement fluctuations
                    const fluctuation = 0.95 + Math.random() * 0.1; // ±5% variation
                    const currentMultiplier = this.multipliers[this.currentRole] * fluctuation;
                    
                    const multiplierEl = document.getElementById('current-multiplier');
                    if (multiplierEl) {
                        multiplierEl.textContent = `${currentMultiplier.toFixed(1)}x`;
                        multiplierEl.style.color = fluctuation > 1 ? '#10b981' : '#ef4444';
                        
                        setTimeout(() => {
                            multiplierEl.style.color = '';
                        }, 500);
                    }
                }, 3000);
            }
        };

        /**
         * Expandable Sections Module
         * Smooth collapsible content with animations
         */
        const ExpandableSections = {
            init() {
                this.createExpandableElements();
                this.bindEvents();
            },
            
            createExpandableElements() {
                const sections = document.querySelectorAll('.content-section');
                sections.forEach(section => {
                    const header = section.querySelector('.section-header');
                    if (header) {
                        header.style.cursor = 'pointer';
                        header.style.position = 'relative';
                        
                        // Add expand/collapse indicator
                        const indicator = document.createElement('div');
                        indicator.className = 'expand-indicator';
                        indicator.innerHTML = '▼';
                        indicator.style.position = 'absolute';
                        indicator.style.right = '1rem';
                        indicator.style.top = '50%';
                        indicator.style.transform = 'translateY(-50%)';
                        indicator.style.transition = 'transform 0.3s ease';
                        header.appendChild(indicator);
                        
                        // Mark section as expandable
                        section.setAttribute('data-expandable', 'true');
                        section.setAttribute('data-expanded', 'true');
                    }
                });
            },
            
            bindEvents() {
                document.querySelectorAll('[data-expandable="true"] .section-header').forEach(header => {
                    header.addEventListener('click', (e) => {
                        const section = header.closest('.content-section');
                        this.toggleSection(section);
                    });
                });
            },
            
            toggleSection(section) {
                const isExpanded = section.getAttribute('data-expanded') === 'true';
                const content = section.querySelector('.section-content, .interactive-container, .code-example');
                const indicator = section.querySelector('.expand-indicator');
                
                if (content) {
                    if (isExpanded) {
                        // Collapse
                        content.style.maxHeight = content.scrollHeight + 'px';
                        content.offsetHeight; // Force reflow
                        content.style.maxHeight = '0';
                        content.style.opacity = '0';
                        content.style.padding = '0';
                        indicator.style.transform = 'translateY(-50%) rotate(-90deg)';
                        section.setAttribute('data-expanded', 'false');
                    } else {
                        // Expand
                        content.style.maxHeight = content.scrollHeight + 'px';
                        content.style.opacity = '1';
                        content.style.padding = '';
                        indicator.style.transform = 'translateY(-50%) rotate(0deg)';
                        section.setAttribute('data-expanded', 'true');
                        
                        // Remove max-height after animation completes
                        setTimeout(() => {
                            content.style.maxHeight = '';
                        }, 300);
                    }
                }
            }
        };

        /**
         * Enhanced Theme Toggle Module
         * Improved theme switching with animations and preferences
         */
        const EnhancedThemeToggle = {
            themes: ['light', 'dark', 'auto'],
            currentTheme: 'light',
            
            init() {
                this.loadSavedTheme();
                this.createThemeSelector();
                this.bindEvents();
                this.detectSystemTheme();
            },
            
            loadSavedTheme() {
                const saved = localStorage.getItem('theme') || 'light';
                this.currentTheme = saved;
                this.applyTheme(saved);
            },
            
            createThemeSelector() {
                const themeToggle = document.getElementById('theme-toggle');
                if (themeToggle) {
                    themeToggle.innerHTML = `
                        <span class="theme-icon">${this.getThemeIcon(this.currentTheme)}</span>
                        <span class="theme-text">${this.getThemeText(this.currentTheme)}</span>
                    `;
                }
            },
            
            bindEvents() {
                const themeToggle = document.getElementById('theme-toggle');
                if (themeToggle) {
                    themeToggle.addEventListener('click', () => {
                        this.cycleTheme();
                    });
                }
                
                // Listen for system theme changes
                if (window.matchMedia) {
                    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', () => {
                        if (this.currentTheme === 'auto') {
                            this.applyTheme('auto');
                        }
                    });
                }
            },
            
            cycleTheme() {
                const currentIndex = this.themes.indexOf(this.currentTheme);
                const nextIndex = (currentIndex + 1) % this.themes.length;
                const nextTheme = this.themes[nextIndex];
                
                this.currentTheme = nextTheme;
                this.applyTheme(nextTheme);
                this.saveTheme(nextTheme);
                this.animateThemeChange();
            },
            
            applyTheme(theme) {
                const html = document.documentElement;
                let actualTheme = theme;
                
                if (theme === 'auto') {
                    actualTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }
                
                html.setAttribute('data-theme', actualTheme);
                this.updateThemeToggle(theme);
            },
            
            updateThemeToggle(theme) {
                const themeToggle = document.getElementById('theme-toggle');
                const icon = themeToggle?.querySelector('.theme-icon');
                const text = themeToggle?.querySelector('.theme-text');
                
                if (icon) icon.textContent = this.getThemeIcon(theme);
                if (text) text.textContent = this.getThemeText(theme);
            },
            
            getThemeIcon(theme) {
                const icons = { light: '🌙', dark: '☀️', auto: '🌗' };
                return icons[theme] || '🌙';
            },
            
            getThemeText(theme) {
                const texts = { light: 'Dark Mode', dark: 'Light Mode', auto: 'Auto Mode' };
                return texts[theme] || 'Dark Mode';
            },
            
            saveTheme(theme) {
                localStorage.setItem('theme', theme);
            },
            
            detectSystemTheme() {
                if (this.currentTheme === 'auto') {
                    this.applyTheme('auto');
                }
            },
            
            animateThemeChange() {
                document.body.style.transition = 'all 0.3s ease';
                setTimeout(() => {
                    document.body.style.transition = '';
                }, 300);
            }
        };

        /**
         * Advanced Navigation Module
         * Enhanced navigation with smooth scrolling and progress tracking
         */
        const AdvancedNavigation = {
            sections: [],
            currentSection: '',
            scrollProgress: 0,
            
            init() {
                this.initializeSections();
                this.createProgressIndicator();
                this.bindEvents();
                this.updateActiveNav();
            },
            
            initializeSections() {
                this.sections = Array.from(document.querySelectorAll('.content-section')).map(section => ({
                    id: section.id,
                    element: section,
                    title: section.querySelector('.section-title')?.textContent || 'Section',
                    offsetTop: section.offsetTop
                }));
            },
            
            createProgressIndicator() {
                const nav = document.querySelector('.main-nav');
                if (nav) {
                    const progressBar = document.createElement('div');
                    progressBar.className = 'nav-progress-bar';
                    progressBar.innerHTML = '<div class="nav-progress-fill"></div>';
                    nav.appendChild(progressBar);
                }
            },
            
            bindEvents() {
                // Enhanced smooth scrolling
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetId = link.getAttribute('href').substring(1);
                        this.smoothScrollTo(targetId);
                    });
                });
                
                // Scroll tracking
                let ticking = false;
                window.addEventListener('scroll', () => {
                    if (!ticking) {
                        requestAnimationFrame(() => {
                            this.updateScrollProgress();
                            this.updateActiveNav();
                            ticking = false;
                        });
                        ticking = true;
                    }
                });
                
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey || e.metaKey) {
                        switch(e.key) {
                            case 'ArrowUp':
                                e.preventDefault();
                                this.navigateToPrevious();
                                break;
                            case 'ArrowDown':
                                e.preventDefault();
                                this.navigateToNext();
                                break;
                        }
                    }
                });
            },
            
            smoothScrollTo(targetId) {
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    const targetTop = targetElement.offsetTop - 100;
                    
                    window.scrollTo({
                        top: targetTop,
                        behavior: 'smooth'
                    });
                    
                    // Visual feedback
                    targetElement.style.outline = '2px solid var(--primary-color)';
                    setTimeout(() => {
                        targetElement.style.outline = 'none';
                    }, 2000);
                }
            },
            
            updateScrollProgress() {
                const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                this.scrollProgress = (winScroll / height) * 100;
                
                const progressFill = document.querySelector('.nav-progress-fill');
                if (progressFill) {
                    progressFill.style.height = `${this.scrollProgress}%`;
                }
            },
            
            updateActiveNav() {
                const scrollPosition = window.pageYOffset + 150;
                let current = '';
                
                this.sections.forEach(section => {
                    if (scrollPosition >= section.element.offsetTop) {
                        current = section.id;
                    }
                });
                
                if (current !== this.currentSection) {
                    this.currentSection = current;
                    
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === '#' + current) {
                            link.classList.add('active');
                        }
                    });
                }
            },
            
            navigateToPrevious() {
                const currentIndex = this.sections.findIndex(s => s.id === this.currentSection);
                const prevIndex = Math.max(0, currentIndex - 1);
                this.smoothScrollTo(this.sections[prevIndex].id);
            },
            
            navigateToNext() {
                const currentIndex = this.sections.findIndex(s => s.id === this.currentSection);
                const nextIndex = Math.min(this.sections.length - 1, currentIndex + 1);
                this.smoothScrollTo(this.sections[nextIndex].id);
            }
        };

        // ==========================================
        // INITIALIZATION AND UTILITY FUNCTIONS
        // ==========================================

        /**
         * Main Application Controller
         */
        const ManusApp = {
            modules: [
                PerformanceTracker,
                FSMDiagram,
                CognitiveEnhancement,
                ExpandableSections,
                EnhancedThemeToggle,
                AdvancedNavigation
            ],
            
            init() {
                console.log('🚀 Initializing Manus FSM Orchestrator Interactive Demo');
                console.log('🧠 Cognitive Enhancement: 2.5x multiplier active');
                
                // Initialize all modules
                this.modules.forEach(module => {
                    try {
                        if (module.init) {
                            module.init();
                            console.log(`✅ ${module.constructor.name || 'Module'} initialized`);
                        }
                    } catch (error) {
                        console.error(`❌ Failed to initialize ${module.constructor.name || 'Module'}:`, error);
                    }
                });
                
                // Additional setup
                this.setupAccessibility();
                this.setupErrorHandling();
                this.setupPerformanceOptimizations();
                
                console.log('🎉 Manus FSM Orchestrator Demo Ready');
            },
            
            setupAccessibility() {
                // Focus management
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Tab') {
                        document.body.classList.add('keyboard-navigation');
                    }
                });
                
                document.addEventListener('mousedown', () => {
                    document.body.classList.remove('keyboard-navigation');
                });
                
                // Skip link functionality
                const skipLink = document.createElement('a');
                skipLink.href = '#main-content';
                skipLink.className = 'skip-link';
                skipLink.textContent = 'Skip to main content';
                skipLink.style.cssText = `
                    position: absolute;
                    top: -40px;
                    left: 6px;
                    background: var(--primary-color);
                    color: white;
                    padding: 8px;
                    text-decoration: none;
                    z-index: 1000;
                    transition: top 0.3s;
                `;
                
                skipLink.addEventListener('focus', () => {
                    skipLink.style.top = '6px';
                });
                
                skipLink.addEventListener('blur', () => {
                    skipLink.style.top = '-40px';
                });
                
                document.body.insertBefore(skipLink, document.body.firstChild);
            },
            
            setupErrorHandling() {
                window.addEventListener('error', (e) => {
                    console.error('🚨 Runtime Error:', e.error);
                    this.showErrorMessage('An unexpected error occurred. Please refresh the page.');
                });
                
                window.addEventListener('unhandledrejection', (e) => {
                    console.error('🚨 Unhandled Promise Rejection:', e.reason);
                    this.showErrorMessage('A background process failed. Some features may not work correctly.');
                });
            },
            
            showErrorMessage(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-toast';
                errorDiv.textContent = message;
                errorDiv.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--error-color);
                    color: white;
                    padding: 12px 16px;
                    border-radius: 6px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    z-index: 10000;
                    animation: slideIn 0.3s ease;
                `;
                
                document.body.appendChild(errorDiv);
                
                setTimeout(() => {
                    errorDiv.remove();
                }, 5000);
            },
            
            setupPerformanceOptimizations() {
                // Lazy loading for heavy content
                if ('IntersectionObserver' in window) {
                    const lazyObserver = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add('lazy-loaded');
                                lazyObserver.unobserve(entry.target);
                            }
                        });
                    });
                    
                    document.querySelectorAll('[data-lazy]').forEach(el => {
                        lazyObserver.observe(el);
                    });
                }
                
                // Preload critical resources
                this.preloadCriticalResources();
            },
            
            preloadCriticalResources() {
                const criticalImages = document.querySelectorAll('img[data-critical]');
                criticalImages.forEach(img => {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.as = 'image';
                    link.href = img.src;
                    document.head.appendChild(link);
                });
            }
        };
        
        // ==========================================
        // APPLICATION STARTUP
        // ==========================================
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => ManusApp.init());
        } else {
            ManusApp.init();
        }
        
        // Export for debugging and testing
        window.ManusApp = ManusApp;
        window.FSMDiagram = FSMDiagram;
        window.CognitiveEnhancement = CognitiveEnhancement;
        window.PerformanceTracker = PerformanceTracker;
        
    </script>
</body>
</html>